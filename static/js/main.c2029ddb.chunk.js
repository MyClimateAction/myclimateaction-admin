(this["webpackJsonpmyclimateaction-admin"]=this["webpackJsonpmyclimateaction-admin"]||[]).push([[0],[,,,,,,,,,,function(t,e,n){t.exports=n(21)},,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var a=n(0),c=n.n(a),o=n(7),r=n.n(o),i=(n(15),n(9)),l=n(1),s=n(2),u=n(4),m=n(3),d=n(5),h=(n(16),n(17),function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return(n=Object(u.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(c)))).state={tokenString:""},n.onTypeChange=function(t){n.setState({tokenString:t.target.value})},n.handleSubmit=function(t){n.props.onAccess(n.state.tokenString),t.preventDefault()},n}return Object(d.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return c.a.createElement("form",{className:"Auth-container",onSubmit:this.handleSubmit},c.a.createElement("label",{className:"Auth-item"},"My climate action admin"),c.a.createElement("input",{className:"Auth-item",onChange:this.onTypeChange,type:"password",placeholder:"Enter auth token"}),c.a.createElement("button",{className:"Auth-item",type:"submit",id:"submit"},"Access"))}}]),e}(a.Component)),p=(n(18),function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return c.a.createElement("header",{className:"TopBar-container"},c.a.createElement("h2",{className:"TopBar-item"},"actions"),c.a.createElement("h1",{className:"TopBar-item"},"MYCLIMATEACTION"),c.a.createElement("button",{className:"TopBar-item",onClick:this.props.logout},"logout"))}}]),e}(a.Component)),f=n(8),E=(n(19),function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(u.a)(this,Object(m.a)(e).call(this,t))).handleEdit=function(){n.setState((function(t){return{isEdit:!t.isEdit}}))},n.modifyAction=function(t,e,a,c){var o={name:e,picture_url:a,frequency:c};n.props.modifyAction(t,o),n.handleEdit()},n.handleUpdateValue=function(t){var e=t.target.value,a=t.target.name;n.setState(Object(f.a)({},a,e))},n.state={isEdit:!1,name:"",picture_url:"",frequency:""},n}return Object(d.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){this.setState({isEdit:!1,name:this.props.name,picture_url:this.props.picture_url,frequency:this.props.frequency})}},{key:"render",value:function(){var t=this;return c.a.createElement("tr",{key:this.props.id},this.state.isEdit&&c.a.createElement(c.a.Fragment,null,c.a.createElement("td",{className:"rowTd"},c.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleUpdateValue})),c.a.createElement("td",{className:"rowTd"},c.a.createElement("select",{name:"frequency",value:this.state.frequency,onChange:this.handleUpdateValue},c.a.createElement("option",{value:"Daily"},"Daily"),c.a.createElement("option",{value:"Weekly"},"Weekly"),c.a.createElement("option",{value:"Monthly"},"Monthly"))),c.a.createElement("td",{className:"rowTd"},c.a.createElement("input",{type:"text",name:"picture_url",value:this.state.picture_url,onChange:this.handleUpdateValue})),c.a.createElement("td",{className:"rowTd"},this.props.votes),c.a.createElement("td",{className:"rowTd"},c.a.createElement("button",{onClick:function(){return t.modifyAction(t.props.id,t.props.name,t.props.picture_url,t.props.frequency)}},"Done"))),!this.state.isEdit&&c.a.createElement(c.a.Fragment,null,c.a.createElement("td",{className:"rowTd"},this.state.name),c.a.createElement("td",{className:"rowTd"},this.state.frequency),c.a.createElement("td",{className:"rowTd"},this.state.picture_url),c.a.createElement("td",{className:"rowTd"},this.state.votes),c.a.createElement("td",{className:"rowTd"},c.a.createElement("button",{onClick:this.handleEdit},"Edit")),c.a.createElement("td",{className:"rowTd"},c.a.createElement("button",{onClick:function(){return t.props.deleteAction(t.props.id)}},"X"))))}}]),e}(a.Component)),y=(n(20),function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(u.a)(this,Object(m.a)(e).call(this,t))).returnTableData=function(){var t,e=n.props.data;return t=e.length?e.map((function(t){return c.a.createElement(E,{key:t.id,id:t.id,name:t.title,frequency:t.frequency,picture_url:t.picture_url,votes:10,modifyAction:n.props.modifyAction,deleteAction:n.props.deleteAction})})):c.a.createElement("tr",null,c.a.createElement("td",null,"No data")),c.a.createElement("table",{className:"Actions-List"},c.a.createElement("thead",null,c.a.createElement("tr",{className:"Actions-tr"},c.a.createElement("td",{className:"rowTd"},"Name"),c.a.createElement("td",{className:"rowTd"},"Frequency"),c.a.createElement("td",{className:"rowTd"},"Image"),c.a.createElement("td",{className:"rowTd"},"Votes"),c.a.createElement("td",{className:"rowTd"},"Edit"),c.a.createElement("td",{className:"rowTd"},"Delete"))),c.a.createElement("tbody",null,t))},n.state={actions:[]},n}return Object(d.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return c.a.createElement("div",null,this.returnTableData(this.state.actions),c.a.createElement("button",null,"Add an Action"))}}]),e}(a.Component)),b=function(t){function e(){var t;return Object(l.a)(this,e),(t=Object(u.a)(this,Object(m.a)(e).call(this))).checkAuth=function(e){t.fetchAuth(e)},t.fetchAuth=function(e){return fetch("".concat("https://myclimateaction.azurewebsites.net","/auth"),{headers:{authorization:e}}).then((function(n){if(!n.ok)throw t.setState({token:void 0}),alert("Invalid auth token"),Error(n.statusText);t.setState({token:e}),localStorage.setItem("token",e),t.fetchData()})).catch((function(e){throw t.setState({token:void 0}),alert("Invalid auth token"),Error(e.message)}))},t.fetchData=function(){fetch("".concat("https://myclimateaction.azurewebsites.net","/actions")).then((function(t){return t.json()})).then((function(e){console.log("fetching"),t.setState({actions:e.data,loading:!1})})).catch((function(t){console.log("Error fetching and parsing data.",t)}))},t.postAction=function(){return fetch("".concat("https://myclimateaction.azurewebsites.net","/action"),{headers:{"Content-type":"application/json",authorization:t.state.token},method:"POST",body:JSON.stringify({title:"hello new action",frequency:"daily",picture_url:"http://123.com"})}).then((function(t){return t.json()})).catch((function(t){console.error(t)}))},t.deleteAction=function(e){return fetch("".concat("https://myclimateaction.azurewebsites.net","/action/").concat(e),{method:"DELETE",headers:{"Content-type":"application/json",authorization:t.state.token}}).then((function(t){return t.ok&&console.log("DELETE!"),t.json()})).catch((function(t){console.error(t)}))},t.handleLogout=function(){localStorage.removeItem("token"),t.setState({actions:[],token:void 0})},t.handleAddAction=function(e,n,a){t.setState((function(c){return{actions:[].concat(Object(i.a)(c.actions),[t.createActionObject(e,n,a)])}}))},t.handleModifyAction=function(e,n){var a;return t.setState((function(t){(a=t.actions).id===e&&(a.name=n.name,a.picture_url=n.picture_url,a.frequency=n.frequency)})),{actions:a}},t.handleDeleteAction=function(e){t.setState((function(t){return{actions:t.actions.filter((function(t){return t.id!==e}))}})),t.deleteAction(e)},t.createActionObject=function(t,e,n){return{title:t,picture_url:e,frequency:n}},t.state={actions:[],token:void 0,loading:!1,auth:!1},t}return Object(d.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){var t=localStorage.getItem("token");t&&this.fetchAuth(t)}},{key:"render",value:function(){return c.a.createElement("div",{className:"App"},!this.state.token&&c.a.createElement("div",{className:"Content"},c.a.createElement(h,{onAccess:this.checkAuth})),this.state.token&&c.a.createElement(c.a.Fragment,null,c.a.createElement(p,{logout:this.handleLogout}),c.a.createElement("div",{className:"Content"},c.a.createElement("h2",null,"Manage actions"),this.state.loading?c.a.createElement("p",null,"Loading..."):c.a.createElement(y,{data:this.state.actions,modifyAction:this.handleModifyAction,deleteAction:this.handleDeleteAction}))))}}]),e}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}],[[10,1,2]]]);
//# sourceMappingURL=main.c2029ddb.chunk.js.map